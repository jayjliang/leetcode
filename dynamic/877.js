/**
 * @param {number[]} piles
 * @return {boolean}
 */
var stoneGame = function (piles) {
    let r = dp(piles, 0, piles.length - 1);
    return r[0] > r[1];
};


var exclude = function (array, indexs) {
    return array.filter((v, i) => {
        return indexs.indexOf(i) === -1;
    })
}
let cache = {};

var dp = function (piles, start, end) {
    let key = start + '-' + end;
    if (cache[key]) {
        return cache[key];
    }
    if (end - start === 1) {
        cache[key] = [Math.max(piles[start], piles[end]), Math.min(piles[start], piles[end])];
        return [Math.max(piles[start], piles[end]), Math.min(piles[start], piles[end])];
    } else {
        let max = [0, 0];
        let s1 = dp(piles, start + 1, end - 1);
        if (s1[0] + piles[start] > max[0]) {
            max = [s1[0] + piles[start], s1[1] + piles[end]];
        }
        if (s1[0] + piles[end] > max[0]) {
            max = [s1[0] + piles[end], s1[1] + piles[start]];
        }
        let s2 = dp(piles, start + 2, end);
        if (s2[0] + piles[start] > max[0]) {
            max = [s2[0] + piles[start], s2[1] + piles[start + 1]];
        }
        let s3 = dp(piles, start, end - 2);
        if (s3[0] + piles[end] > max[0]) {
            max = [s3[0] + piles[end], s3[1] + piles[end - 1]];
        }
        cache[key] = [max[0], max[1]];
        return max;
    }
}
console.log(stoneGame([162, 259, 203, 207, 455, 174, 414, 403, 49, 125, 104, 87, 273, 354, 345, 299, 132, 240, 427, 242, 497, 364, 289, 431, 176, 99, 154, 18, 92, 300, 397, 395, 208, 388, 379, 203, 16, 413, 223, 60, 422, 410, 310, 409, 295, 306, 230, 417, 382, 379, 305, 275, 221, 370, 173, 328, 96, 450, 52, 351, 250, 122, 331, 17, 203, 76, 384, 137, 31, 396, 383, 487, 67, 212, 198, 241, 22, 85, 253, 28, 92, 210, 294, 444, 159, 382, 52, 277, 145, 225, 60, 140, 198, 460, 355, 66, 81, 370, 149, 147, 311, 335, 445, 481, 80, 370, 332, 175, 8, 8, 274, 427, 87, 267, 15, 89, 135, 279, 318, 123, 282, 254, 302, 457, 495, 252, 125, 408, 430, 178, 318, 411, 324, 99, 59, 312, 496, 320, 76, 445, 373, 382, 104, 15, 106, 119, 379, 296, 86, 245, 260, 415, 193, 14, 336, 347, 81, 434, 467, 155, 472, 317, 65, 411, 140, 74, 156, 433, 65, 226, 416, 483, 411, 215, 468, 447, 14, 375, 137, 304, 86, 10, 87, 306, 162, 426, 350, 107, 194, 50, 9, 480, 344, 156, 314, 388, 172, 206, 114, 181, 12, 155, 405, 465, 333, 314, 224, 371, 414, 423, 82, 493, 128, 462, 397, 128, 7, 126, 74, 393, 106, 66, 115, 185, 445, 254, 262, 183, 192, 222, 416, 8, 103, 8, 436, 349, 376, 488, 77, 149, 460, 327, 387, 85, 350, 72, 343, 150, 53, 410, 33, 23, 212, 68, 156, 319, 38, 391, 280, 220, 82, 117, 113, 459, 104, 305, 385, 330, 285, 248, 91, 313, 55, 492, 197, 36, 264, 333, 26, 192, 106, 81, 309, 207, 348, 134, 108, 325, 406, 140, 41, 367, 327, 402, 432, 419, 454, 336, 459, 49, 118, 289, 177, 161, 249, 295, 455, 252, 388, 164, 304, 465, 284, 404, 163, 23, 252, 60, 42, 471, 199, 52, 192, 401, 113, 428, 426, 454, 109, 111, 363, 152, 83, 287, 4, 31, 125, 186, 137, 365, 269, 417, 350, 292, 385, 372, 280, 243, 470, 465, 335, 194, 351, 319, 499, 329, 214, 140, 350, 348, 83, 374, 144, 3, 118, 321, 258, 196, 302, 307, 399, 122, 487, 111, 480, 205, 106, 270, 173, 80, 278, 252, 300, 127, 123, 63, 172, 131, 355, 223, 241, 49, 297, 323, 73, 388, 380, 147, 167, 63, 487, 320, 140, 86, 315, 462, 425, 463, 171, 333, 310, 436, 448, 76, 478, 245, 179, 450, 56, 324, 92, 401, 483, 321, 133, 19, 400, 262, 74, 61, 313, 268, 276, 337, 353, 118, 442, 234, 356, 374, 83, 60, 319, 355, 242, 89, 296, 179, 323, 33, 394, 410, 65, 198, 396, 238, 464, 258, 464, 278, 60, 316, 298, 141, 34, 152, 196, 102, 124, 442, 491, 456, 34, 413, 234, 483, 382, 192, 50, 90, 30, 215, 127, 464, 11, 403, 44, 162, 216, 130, 399, 262, 238, 215, 6, 483, 262, 49, 280, 379]))